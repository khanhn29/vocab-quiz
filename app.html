<!DOCTYPE html>
<html lang="vi">
<head>
    <!-- Google tag (gtag.js) -->
    <script src="analytics.js"></script>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Học từ vựng tiếng Hàn</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f8f9fa;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .back-button {
            position: fixed;
            top: 20px;
            left: 20px;
            background: linear-gradient(135deg, #6c757d, #495057);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 12px 16px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            z-index: 1000;
        }

        .back-button:hover {
            background: linear-gradient(135deg, #495057, #343a40);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .back-button:active {
            transform: translateY(0);
        }

        .back-arrow {
            font-size: 1.1rem;
        }

        .container {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.08);
            padding: 40px;
            max-width: 500px;
            width: 100%;
        }

        .question-counter {
            text-align: center;
            font-size: 1.2rem;
            font-weight: 600;
            color: #6c757d;
            margin-bottom: 20px;
            padding: 12px 24px;
            background: #e9ecef;
            border-radius: 25px;
            display: inline-block;
            margin-left: 50%;
            transform: translateX(-50%);
        }

        .vietnamese-word {
            text-align: center;
            font-size: 2rem;
            font-weight: 700;
            color: #1a1a1a;
            margin-bottom: 40px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
            border: 2px solid #e9ecef;
            position: relative;
        }

        .sound-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            cursor: pointer;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(40, 167, 69, 0.3);
        }

        .sound-btn:hover {
            transform: scale(1.1);
            background: linear-gradient(135deg, #218838, #1fa187);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.4);
        }

        .sound-btn:active {
            transform: scale(0.95);
        }

        .sound-btn.playing {
            animation: soundPulse 1s ease-in-out infinite;
        }

        @keyframes soundPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .auto-play-info {
            font-size: 0.85rem;
            color: #6c757d;
            margin-top: 10px;
            font-style: italic;
            display: none;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 32px;
        }

        .option {
            position: relative;
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            font-size: 1.6rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .option:hover:not(.disabled) {
            border-color: #007bff;
            background: #f8f9ff;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 123, 255, 0.15);
        }

        .option-number {
            position: absolute;
            top: 8px;
            left: 12px;
            background: #6c757d;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85rem;
            font-weight: 600;
        }
        
        .option-text {
            display: block;
            width: 100%;
            text-align: center;
            font-size: 1.6rem;
            font-weight: 600;
        }

        .option.correct {
            border-color: #28a745 !important;
            background: #d4edda !important;
            color: #155724 !important;
        }

        .option.correct .option-number {
            background: #28a745 !important;
        }

        .option.incorrect {
            border-color: #dc3545 !important;
            background: #f8d7da !important;
            color: #721c24 !important;
        }

        .option.incorrect .option-number {
            background: #dc3545 !important;
        }

        .option.disabled {
            cursor: not-allowed !important;
            opacity: 0.8;
        }

        .feedback {
            text-align: center;
            margin: 20px 0;
            font-size: 1.1rem;
            font-weight: 600;
            min-height: 30px;
        }

        .feedback.success {
            color: #28a745;
        }

        .feedback.error {
            color: #dc3545;
        }

        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 32px;
        }

        .next-btn {
            background: #007bff;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 24px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .next-btn:hover:not(:disabled) {
            background: #0056b3;
            transform: translateY(-1px);
        }

        .next-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
        }

        .dont-know-btn {
            background: transparent;
            color: #6c757d;
            border: none;
            font-size: 0.9rem;
            cursor: pointer;
            text-decoration: underline;
            opacity: 0.7;
            transition: opacity 0.2s ease;
        }

        .dont-know-btn:hover {
            opacity: 1;
        }

        .check-mark, .x-mark {
            position: absolute;
            top: 8px;
            right: 12px;
            font-size: 1.2rem;
        }

        .check-mark {
            color: #28a745;
        }

        .x-mark {
            color: #dc3545;
        }

        /* Animation for correct answer */
        .option.correct-animation {
            animation: correctPulse 0.6s ease-out;
        }

        @keyframes correctPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); box-shadow: 0 4px 20px rgba(40, 167, 69, 0.3); }
            100% { transform: scale(1); }
        }

        /* Completion message styles */
        .lesson-name {
            font-size: 1.1rem;
            color: #6c757d;
            margin-top: 16px;
            font-style: italic;
            text-align: center;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 24px;
                margin: 10px;
            }

            .vietnamese-word {
                font-size: 2rem;
                margin-bottom: 32px;
                padding: 16px;
            }

            .options-grid {
                gap: 12px;
                margin-bottom: 24px;
            }

            .option {
                padding: 16px;
                font-size: 1.1rem;
                min-height: 70px;
            }

            .controls {
                flex-direction: column;
                gap: 16px;
                align-items: stretch;
            }

            .dont-know-btn {
                text-align: center;
            }

            .back-button {
                top: 15px;
                left: 15px;
                padding: 10px 12px;
                font-size: 0.8rem;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }

            .container {
                padding: 16px;
                margin: 0;
            }

            .vietnamese-word {
                font-size: 1.6rem;
                padding: 12px;
                margin-bottom: 20px;
            }

            .options-grid {
                grid-template-columns: 1fr;
                gap: 10px;
                margin-bottom: 20px;
            }

            .option {
                font-size: 1.1rem;
                padding: 12px;
                min-height: 56px;
            }

            .controls {
                flex-direction: column;
                gap: 10px;
                margin-top: 20px;
            }

            .question-counter {
                font-size: 1rem;
                padding: 8px 16px;
                margin-bottom: 16px;
            }

            .auto-play-info {
                font-size: 0.75rem;
                margin-top: 6px;
            }

            .back-button {
                top: 10px;
                left: 10px;
                padding: 8px 10px;
                font-size: 0.75rem;
                gap: 6px;
            }

            .back-arrow {
                font-size: 0.9rem;
            }
        }

    </style>
</head>
<body>
    <button class="back-button" onclick="goToIndex()">
        <span class="back-arrow">←</span>
        <span>Quay lại</span>
    </button>

    <div class="container">
        <div class="question-counter" id="questionCounter">Câu 1 / 30</div>
        <div class="vietnamese-word" id="vietnameseWord"></div>
        
        <div class="options-grid" id="optionsGrid">
            <div class="option" id="option0">
                <span class="option-number">1</span>
                <span class="option-text"></span>
            </div>
            <div class="option" id="option1">
                <span class="option-number">2</span>
                <span class="option-text"></span>
            </div>
            <div class="option" id="option2">
                <span class="option-number">3</span>
                <span class="option-text"></span>
            </div>
            <div class="option" id="option3">
                <span class="option-number">4</span>
                <span class="option-text"></span>
            </div>
        </div>

        <div class="feedback" id="feedback"></div>

        <div class="controls">
            <button class="next-btn" id="nextBtn" disabled>Tiếp theo</button>
        </div>
    </div>

    <!-- Hidden audio element for playing sounds -->
    <audio id="audioPlayer" preload="none"></audio>
    
    <script>
        // Tất cả từ vựng được lưu trữ trực tiếp trong ứng dụng
        const vocabularyData = {
            'l1-v1-jobs': [
                { "vi": "Học sinh", "han": "학생" },
                { "vi": "Bác sĩ", "han": "의사" },
                { "vi": "Dược sĩ", "han": "약사" },
                { "vi": "Nhân viên công ty", "han": "회사원" },
                { "vi": "Công chức", "han": "공무원" },
                { "vi": "Lái xe", "han": "운전기사" },
                { "vi": "Hướng dẫn viên du lịch (cách 1)", "han": "관광가이드" },
                { "vi": "Hướng dẫn viên du lịch (cách 2)", "han": "여행안내원" },
                { "vi": "Nội trợ", "han": "주부" },
                { "vi": "Giáo viên", "han": "선생님" },
                { "vi": "Nhân viên ngân hàng", "han": "은행원" }
            ],
            'l1-v2-vocab': [
                { "vi": "khoa ngữ văn", "han": "국어국문학과" },
                { "vi": "quốc tịch", "han": "국적" },
                { "vi": "vâng", "han": "네" },
                { "vi": "trường đại học", "han": "대학교" },
                { "vi": "sinh viên", "han": "대학생" },
                { "vi": "người (kính ngữ, cách nói kính trọng của 사람)", "han": "분" },
                { "vi": "mẫu, ví dụ", "han": "보기" },
                { "vi": "người", "han": "사람" },
                { "vi": "bạn", "han": "씨" },
                { "vi": "không", "han": "아니요" },
                { "vi": "ngân hàng", "han": "은행" },
                { "vi": "này", "han": "이" },
                { "vi": "tên", "han": "이름" },
                { "vi": "email, thư điện tử", "han": "이메일" },
                { "vi": "tôi", "han": "저" },
                { "vi": "điện thoại", "han": "전화" },
                { "vi": "của tôi/ tôi", "han": "제" },
                { "vi": "địa chỉ", "han": "주소" },
                { "vi": "nghề nghiệp", "han": "직업" },
                { "vi": "khoa/ bộ môn", "han": "학과" },
                { "vi": "mã số sinh viên", "han": "학번" },
                { "vi": "thẻ sinh viên", "han": "학생증" },
                { "vi": "tiếng Hàn", "han": "한국어" },
                { "vi": "khoa tiếng Hàn", "han": "한국어과" }
            ],
            'l1-v3-countries': [
                { "vi": "Hàn Quốc", "han": "한국" },
                { "vi": "Mỹ", "han": "미국" },
                { "vi": "Mông Cổ", "han": "몽골" },
                { "vi": "Anh", "han": "영국" },
                { "vi": "Việt Nam", "han": "베트남" },
                { "vi": "Trung Quốc", "han": "중국" },
                { "vi": "Indonesia", "han": "인도네시아" },
                { "vi": "Đức", "han": "독일" },
                { "vi": "Malaysia", "han": "말레이시아" },
                { "vi": "Thái Lan", "han": "태국" },
                { "vi": "Philipin", "han": "필리핀" },
                { "vi": "Pháp", "han": "프랑스" },
                { "vi": "Nhật", "han": "일본" },
                { "vi": "Úc", "han": "호주" },
                { "vi": "Nga", "han": "러시아" },
                { "vi": "Ấn Độ", "han": "인도" }
            ],
            'l2-v1-places': [
                {"vi": "trường học", "han": "학교"}, 
                {"vi": "nhà hát/rạp chiếu phim", "han": "극장"}, 
                {"vi": "trung tâm thương mại", "han": "백화점"}, 
                {"vi": "thư viện", "han": "도서관"}, 
                {"vi": "bưu điện", "han": "우체국"}, 
                {"vi": "hiệu thuốc", "han": "약국"}, 
                {"vi": "nhà ăn, nhà hàng", "han": "식당"}, 
                {"vi": "bệnh viện", "han": "병원"}, 
                {"vi": "cửa tiệm, cửa hàng", "han": "가게"}, 
                {"vi": "khách sạn", "han": "호텔"}, 
                {"vi": "ngân hàng", "han": "은행"}, 
                {"vi": "văn phòng", "han": "사무실"}
            ],
            'l2-v2-school': [
                {"vi": "giảng đường, phòng học", "han": "강의실"},
                {"vi": "phòng học", "han": "교실"},
                {"vi": "phòng Lab", "han": "랩실"},
                {"vi": "giảng đường lớn, hội trường", "han": "강당"},
                {"vi": "phòng sinh hoạt câu lạc bộ", "han": "동아리방"},
                {"vi": "nhà ăn học sinh", "han": "학생 식당"},
                {"vi": "phòng vệ sinh", "han": "화장실"},
                {"vi": "nhà thi đấu thể thao/ nhà thể chất", "han": "체육관"},
                {"vi": "phòng hội thảo", "han": "세미나실"},
                {"vi": "phòng nghỉ", "han": "휴게실"},
                {"vi": "sân vận động", "han": "운동장"},
                {"vi": "hiệu sách", "han": "서점"}
            ],
            'l2-v3-classroom': [
                { "vi": "cái bàn", "han": "책상" },
                { "vi": "cửa sổ", "han": "창문" },
                { "vi": "bản đồ", "han": "지도" },
                { "vi": "cái ghế", "han": "의자" },
                { "vi": "vở", "han": "공책" },
                { "vi": "bảng", "han": "칠판" },
                { "vi": "cặp sách", "han": "가방" },
                { "vi": "từ điển", "han": "사전" },
                { "vi": "hộp bút", "han": "필통" },
                { "vi": "máy vi tính", "han": "컴퓨터" },
                { "vi": "tẩy/ cục tẩy", "han": "지우개" },
                { "vi": "bút, viết", "han": "펜" },
                { "vi": "sách", "han": "책" },
                { "vi": "đồng hồ", "han": "시계" },
                { "vi": "cửa ra vào", "han": "문" }
            ],
            'l3-v1-verbs': [
                { "vi": "đi", "han": "가다" },
                { "vi": "đến", "han": "오다" },
                { "vi": "ngủ", "han": "자다" },
                { "vi": "ăn", "han": "먹다" },
                { "vi": "uống", "han": "마시다" },
                { "vi": "nói chuyện", "han": "이야기하다" },
                { "vi": "đọc", "han": "읽다" },
                { "vi": "nghe", "han": "듣다" },
                { "vi": "xem, nhìn", "han": "보다" },
                { "vi": "làm việc", "han": "일하다" },
                { "vi": "tự học", "han": "공부하다" },
                { "vi": "học từ người khác dạy", "han": "배우다" },
                { "vi": "luyện tập thể thao", "han": "운동하다" },
                { "vi": "nghỉ ngơi", "han": "쉬다" },
                { "vi": "gặp gỡ", "han": "만나다" },
                { "vi": "mua", "han": "사다" },
                { "vi": "thích", "han": "좋아하다" }
            ],
            'l3-v2-adjectives': [
                { "vi": "to, lớn, cao", "han": "크다" },
                { "vi": "nhỏ, bé thấp", "han": "작다" },
                { "vi": "nhiều", "han": "많다" },
                { "vi": "ít", "han": "적다" },
                { "vi": "tốt", "han": "좋다" },
                { "vi": "xấu, tồi", "han": "나쁘다" },
                { "vi": "thú vị", "han": "재미있다" },
                { "vi": "không hay, không thú vị", "han": "재미없다" }
            ],
            'l3-v3-daily': [
                { "vi": "trà", "han": "차" },
                { "vi": "cà phê", "han": "커피" },
                { "vi": "bánh mì", "han": "빵" },
                { "vi": "sữa", "han": "우유" },
                { "vi": "phim", "han": "영화" },
                { "vi": "âm nhạc", "han": "음악" },
                { "vi": "báo", "han": "신문" },
                { "vi": "bạn bè", "han": "친구" },
                { "vi": "cơm", "han": "밥" },
                { "vi": "tiền", "han": "돈" }
            ],
            'l3-v4-question': [
                { "vi": "cái gì", "han": "무엇" },
                { "vi": "đâu", "han": "어디" },
                { "vi": "ai", "han": "누구" },
                { "vi": "khi nào, bao giờ", "han": "언제" },
                { "vi": "áo", "han": "옷" },
                { "vi": "email, thư điện tử", "han": "이메일" },
                { "vi": "trên", "han": "위" },
                { "vi": "gọi điện thoại", "han": "전화하다" },
                { "vi": "bây giờ", "han": "지금" },
                { "vi": "đá bóng", "han": "축구를 하다" },
                { "vi": "quán cà phê", "han": "카페" },
                { "vi": "câu lạc bộ thể dục thể thao", "han": "헬스클럽" }
            ],
            'l3-v5-vocab': [
                { "vi": "công viên", "han": "공원" },
                { "vi": "bài hát", "han": "노래" },
                { "vi": "tòa nhà Đại Hàn", "han": "대한빌딩" },
                { "vi": "phòng", "han": "방" },
                { "vi": "táo", "han": "사과" },
                { "vi": "đi dạo", "han": "산책하다" },
                { "vi": "mua sắm", "han": "쇼핑하다" },
                { "vi": "nội thành, trung tâm thành phố", "han": "시내" },
                { "vi": "chợ", "han": "시장" },
                { "vi": "dùng bữa", "han": "식사하다" },
                { "vi": "báo", "han": "신문" },
                { "vi": "kem", "han": "아이스크림" },
                { "vi": "rất", "han": "아주" },
                { "vi": "du lịch", "han": "여행" }
            ],
            'l4-v1-months': [
                { "vi": "tháng giêng (một)", "han": "일월" },
                { "vi": "tháng hai", "han": "이월" },
                { "vi": "tháng ba", "han": "삼월" },
                { "vi": "tháng tư", "han": "사월" },
                { "vi": "tháng năm", "han": "오월" },
                { "vi": "tháng sáu", "han": "유월" },
                { "vi": "tháng bảy", "han": "칠월" },
                { "vi": "tháng tám", "han": "팔월" },
                { "vi": "tháng chín", "han": "구월" },
                { "vi": "tháng mười", "han": "시월" },
                { "vi": "tháng mười một", "han": "십일월" },
                { "vi": "tháng mười hai", "han": "십이월" }
            ],
            'l4-v2-timeUnitsAndDays': [
                { "vi": "năm", "han": "년" },
                { "vi": "tháng", "han": "월" },
                { "vi": "ngày", "han": "일" },
                { "vi": "giờ", "han": "시" },
                { "vi": "Chủ nhật", "han": "일요일" },
                { "vi": "Thứ hai", "han": "월요일" },
                { "vi": "Thứ ba", "han": "화요일" },
                { "vi": "Thứ năm", "han": "목요일" },
                { "vi": "Thứ sáu", "han": "금요일" },
                { "vi": "Thứ bảy", "han": "토요일" },
                { "vi": "ngày thường (trong tuần)", "han": "평일(주중)" },
                { "vi": "cuối tuần", "han": "주말" }
            ],
            'l4-v3-timeRelative': [
                { "vi": "hôm kia", "han": "그저께" },
                { "vi": "hôm qua", "han": "어제" },
                { "vi": "hôm nay", "han": "오늘" },
                { "vi": "ngày mai", "han": "내일" },
                { "vi": "ngày kia", "han": "모레" },
                { "vi": "tuần trước", "han": "지난 주" },
                { "vi": "tuần này", "han": "이번 주" },
                { "vi": "tuần sau", "han": "다음주" },
                { "vi": "tháng trước", "han": "지난 달" },
                { "vi": "tháng này", "han": "이번달" },
                { "vi": "tháng sau", "han": "다음달" },
                { "vi": "năm trước, năm ngoái", "han": "지난 해 (작년)" },
                { "vi": "năm nay", "han": "올해 (금년)" }
            ],
            'l4-v4-eventsActivities': [
                { "vi": "năm sau", "han": "다음해 (내년)" },
                { "vi": "ngày Tết", "han": "설날" },
                { "vi": "Giáng sinh", "han": "크리스마스" },
                { "vi": "ngày kỉ niệm chữ Hangeul", "han": "한글날" },
                { "vi": "ngày lễ", "han": "명절" },
                { "vi": "tiệc sinh nhật", "han": "생일 파티" },
                { "vi": "tổ chức tiệc", "han": "파티를 하다" },
                { "vi": "họp, hội nghị", "han": "회의하다" },
                { "vi": "tốt nghiệp", "han": "졸업하다" },
                { "vi": "kỳ thi, kỳ kiểm tra", "han": "시험" },
                { "vi": "kỳ nghỉ", "han": "휴가" },
                { "vi": "kỳ nghỉ (của học sinh)", "han": "방학" },
                { "vi": "sự làm thêm", "han": "아르바이트" }
            ],
            'l4-v5-peopleAndMisc': [
                { "vi": "giảng viên", "han": "강사" },
                { "vi": "ngắm, xem", "han": "구경하다" },
                { "vi": "quán cà phê", "han": "커피숍" },
                { "vi": "núi", "han": "산" },
                { "vi": "tầng", "han": "층" },
                { "vi": "số (phòng)", "han": "호" },
                { "vi": "bảng kế hoạch", "han": "계획표" },
                { "vi": "số điện thoại", "han": "전화번호" },
                { "vi": "sự hướng dẫn", "han": "안내" },
                { "vi": "đẹp", "han": "아름답다" },
                { "vi": "và", "han": "그리고" }
            ],
            'l4-v6-numbersv0': [
                { "vi": "không", "han": "영, 공" },
                { "vi": "một", "han": "일" },
                { "vi": "hai", "han": "이" },
                { "vi": "ba", "han": "삼" },
                { "vi": "bốn", "han": "사" },
                { "vi": "năm", "han": "오" },
                { "vi": "sáu", "han": "육" },
                { "vi": "bảy", "han": "칠" },
                { "vi": "tám", "han": "팔" },
                { "vi": "chín", "han": "구" },
                { "vi": "mười", "han": "십" },
                { "vi": "mười một", "han": "십일" },
                { "vi": "mười hai", "han": "십이" }
            ],
            'l4-v7-numbersv1': [
                { "vi": "hai mươi", "han": "이십" },
                { "vi": "ba mươi", "han": "삼십" },
                { "vi": "bốn mươi", "han": "사십" },
                { "vi": "năm mươi", "han": "오십" },
                { "vi": "sáu mươi", "han": "육십" },
                { "vi": "bảy mươi", "han": "칠십" },
                { "vi": "tám mươi", "han": "팔십" },
                { "vi": "chín mươi", "han": "구십" }
            ],
            'l4-v8-numbersv2': [
                { "vi": "một trăm", "han": "백" },
                { "vi": "hai trăm", "han": "이백" },
                { "vi": "một nghìn", "han": "천" },
                { "vi": "mười nghìn", "han": "만" },
                { "vi": "một trăm nghìn", "han": "십만" },
                { "vi": "một triệu", "han": "백만" },
                { "vi": "mười triệu", "han": "천만" },
                { "vi": "một trăm triệu", "han": "억" },
                { "vi": "một tỉ", "han": "십억" }
            ],
            'l5-v1-timeOfDay': [
                { "vi": "buổi sáng", "han": "오전" },
                { "vi": "buổi chiều", "han": "오후" },
                { "vi": "ban ngày", "han": "낮" },
                { "vi": "ban đêm", "han": "밤" },
                { "vi": "sáng", "han": "아침" },
                { "vi": "trưa", "han": "점심" },
                { "vi": "tối", "han": "저녁" },
                { "vi": "sáng sớm", "han": "새벽" },
                { "vi": "giờ", "han": "시" },
                { "vi": "phút", "han": "분" },
                { "vi": "giây", "han": "초" }
            ],
            'l5-v2-dailyActivities': [
                { "vi": "thức dậy", "han": "일어나다" },
                { "vi": "đánh răng", "han": "이를 닦다" },
                { "vi": "rửa mặt", "han": "세수하다" },
                { "vi": "học", "han": "배우다" },
                { "vi": "tan tầm", "han": "퇴근하다" },
                { "vi": "giặt giũ", "han": "세탁하다" },
                { "vi": "bắt đầu", "han": "시작하다" },
                { "vi": "dọn vệ sinh", "han": "청소하다" },
                { "vi": "xong, kết thúc", "han": "끝나다" },
                { "vi": "chuẩn bị bữa sáng", "han": "아침 준비하다" },
                { "vi": "tắm", "han": "샤워하다" },
                { "vi": "ngủ", "han": "자다" },
                { "vi": "đi lại", "han": "다니다" },
                { "vi": "đi làm", "han": "출근하다" }
            ],
            'l5-v3-vocabulary': [
                { "vi": "mùa đông", "han": "겨울" },
                { "vi": "quê hương", "han": "고향" },
                { "vi": "sân bay", "han": "공항" },
                { "vi": "ngày", "han": "날" },
                { "vi": "đàn ông", "han": "남자" },
                { "vi": "quán karaoke", "han": "노래방" },
                { "vi": "nhận", "han": "받다" },
                { "vi": "cơm", "han": "밥" },
                { "vi": "bố mẹ", "han": "부모님" },
                { "vi": "giờ học, buổi học", "han": "수업" },
                { "vi": "bơi lội", "han": "수영" },
                { "vi": "thi", "han": "시험을 보다" },
                { "vi": "phụ nữ", "han": "여자" },
                { "vi": "khoa Ngữ văn Anh", "han": "영문과" },
                { "vi": "tiếng Anh", "han": "영어" }
            ],
            'l5-v4-miscellaneous': [
                { "vi": "lái xe", "han": "운전하다" },
                { "vi": "internet", "han": "인터넷" },
                { "vi": "nhật kí", "han": "일기" },
                { "vi": "quán internet", "han": "PC방" },
                { "vi": "họp, hội thảo", "han": "회의" },
                { "vi": "công ty", "han": "회사" },
                { "vi": "sau, sau khi", "han": "후" },
                { "vi": "xuất phát", "han": "출발하다" },
                { "vi": "đi làm", "han": "출근" },
                { "vi": "nhà", "han": "집" },
                { "vi": "phụ nữ", "han": "여성" }
            ]
        };

        const params = new URLSearchParams(window.location.search);
        const vocabFile = params.get("vocab");
        const audioPath = params.get("audio") || "audio/lesson1/jobs"; // Default path
        
        // Biến global để lưu từ vựng hiện tại
        let vocabulary = [];

        // Hàm quay lại trang index
        function goToIndex() {
            window.location.href = 'index.html';
        }
    </script>
    <script>
        // vocabulary đã được định nghĩa ở trên

        let currentQuestion = null;
        let correctAnswer = null;
        let hasAnswered = false;
        let currentAnswers = [];
        let questionQueue = [];
        let currentQuestionIndex = 0;
        let totalQuestions = 0;
        let audioSupported = true;
        let currentAudioPath = "";
        let wrongAnswerCount = 0;
        let correctAnswerCount = 0;

        // Hàm lấy tên bài học từ vocabFile parameter
        function getLessonName(vocabFile) {
            const lessonNames = {
                // Bài 1
                'l1-v1-jobs': 'Bài 1 - Phần 1: Nghề nghiệp',
                'l1-v2-vocab': 'Bài 1 - Phần 2: Từ mới',
                'l1-v3-countries': 'Bài 1 - Phần 3: Quốc gia',
                
                // Bài 2
                'l2-v1-places': 'Bài 2 - Phần 1: Nơi chốn',
                'l2-v2-school': 'Bài 2 - Phần 2: Trang thiết bị trường học',
                'l2-v3-classroom': 'Bài 2 - Phần 3: Đồ vật trong phòng học',
                
                // Bài 3
                'l3-v1-verbs': 'Bài 3 - Phần 1: Động từ',
                'l3-v2-adjectives': 'Bài 3 - Phần 2: Tính từ',
                'l3-v3-daily': 'Bài 3 - Phần 3: Sinh hoạt hằng ngày',
                'l3-v4-question': 'Bài 3 - Phần 4: Đại từ nghi vấn',
                'l3-v5-vocab': 'Bài 3 - Phần 5: Từ mới',
                
                // Bài 4
                'l4-v1-months': 'Bài 4 - Phần 1: Tháng',
                'l4-v2-timeUnitsAndDays': 'Bài 4 - Phần 2: Đơn vị thời gian và ngày trong tuần',
                'l4-v3-timeRelative': 'Bài 4 - Phần 3: Thời gian tương đối',
                'l4-v4-eventsActivities': 'Bài 4 - Phần 4: Sự kiện và hoạt động',
                'l4-v5-peopleAndMisc': 'Bài 4 - Phần 5: Con người và từ khác',
                'l4-v6-numbersv0': 'Bài 4 - Phần 6: Số đếm từ 0-12',
                'l4-v7-numbersv1': 'Bài 4 - Phần 7: Số đếm từ 20-90',
                'l4-v8-numbersv2': 'Bài 4 - Phần 8: Số đếm từ 100 trở lên'
            };
            
            return lessonNames[vocabFile] || 'Bài học từ vựng';
        }

        // Khởi tạo
        function init() {
            console.log('Khởi tạo ứng dụng...');
            currentAudioPath = audioPath;
            setupQuestionQueue();
            loadNewQuestion();
            setupEventListeners();
        }

        // Tạo hàng đợi câu hỏi (mỗi từ xuất hiện 1 lần: chỉ KR->VN)
        function setupQuestionQueue() {
            questionQueue = [];
            
            // Chỉ thêm câu hỏi KR->VN (Tiếng Hàn hỏi, Việt trả lời)
            vocabulary.forEach(word => {
                questionQueue.push({...word, type: 'kr-vn'}); // Tiếng Hàn hỏi, Việt trả lời
            });
            
            // Trộn ngẫu nhiên
            questionQueue = shuffleArray(questionQueue);
            totalQuestions = questionQueue.length;
            currentQuestionIndex = 0;
            
            console.log('Tổng số câu hỏi:', totalQuestions);
            updateQuestionCounter();
        }

        // Thiết lập event listeners
        function setupEventListeners() {
            // Next button
            document.getElementById('nextBtn').addEventListener('click', loadNewQuestion);
            
            // Option buttons
            for (let i = 0; i < 4; i++) {
                document.getElementById('option' + i).addEventListener('click', function() {
                    console.log('Clicked option', i, 'with text:', currentAnswers[i]);
                    selectAnswer(i, currentAnswers[i]);
                });
            }
            
            // Keyboard shortcuts
            document.addEventListener('keydown', function(event) {
                if (hasAnswered && event.key === 'Enter') {
                    loadNewQuestion();
                } else if (!hasAnswered && event.key >= '1' && event.key <= '4') {
                    const optionIndex = parseInt(event.key) - 1;
                    selectAnswer(optionIndex, currentAnswers[optionIndex]);
                } else if (event.code === 'Space') {
                    event.preventDefault();
                    playKoreanWord();
                }
            });
        }

        // Tải câu hỏi mới
        function loadNewQuestion() {
            console.log('Tải câu hỏi mới...');
            
            // Kiểm tra xem còn câu hỏi không
            if (currentQuestionIndex >= questionQueue.length) {
                showCompletionMessage();
                return;
            }
            
            // Reset trạng thái
            hasAnswered = false;
            document.getElementById('feedback').textContent = '';
            document.getElementById('feedback').className = 'feedback';
            document.getElementById('nextBtn').disabled = true;
            
            // Reset options
            for (let i = 0; i < 4; i++) {
                const option = document.getElementById('option' + i);
                option.className = 'option';
                
                // Xóa các icon cũ
                const existingIcons = option.querySelectorAll('.check-mark, .x-mark');
                existingIcons.forEach(icon => icon.remove());
            }
            
            // Lấy từ từ queue
            currentQuestion = questionQueue[currentQuestionIndex];
            
            // Câu hỏi tiếng Hàn -> đáp án tiếng Việt
            correctAnswer = currentQuestion.vi;
            
            // Hiển thị từ tiếng Hàn với nút phát âm
            const vietnameseElement = document.getElementById('vietnameseWord');
            vietnameseElement.innerHTML = `
                <button class="sound-btn" onclick="playKoreanWord()" title="Phát âm từ tiếng Hàn: ${currentQuestion.han}">🔊</button>
                ${currentQuestion.han}
            `;
            
            // Tự động phát âm khi tải câu hỏi tiếng Hàn
            setTimeout(() => {
                playKoreanWord();
            }, 500);
            
            // Tạo đáp án tiếng Việt
            const wrongAnswers = getRandomWrongAnswers(correctAnswer, 3, 'vi');
            currentAnswers = shuffleArray([correctAnswer, ...wrongAnswers]);
            
            console.log('Câu hỏi KR->VN:', currentQuestion.han, '- Đáp án:', correctAnswer);
            console.log('Câu thứ:', currentQuestionIndex + 1, '/', totalQuestions);
            
            // Cập nhật counter
            updateQuestionCounter();
            
            console.log('Các đáp án:', currentAnswers);
            
            // Hiển thị đáp án
            for (let i = 0; i < 4; i++) {
                const optionElement = document.getElementById('option' + i);
                const textElement = optionElement.querySelector('.option-text');
                textElement.textContent = currentAnswers[i];
            }
            
            // Chuyển sang câu tiếp theo
            currentQuestionIndex++;
        }

        // Lấy đáp án sai ngẫu nhiên
        function getRandomWrongAnswers(correctAnswer, count, language) {
            let wrongAnswers;
            
            if (language === 'han') {
                // Lấy đáp án sai tiếng Hàn
                wrongAnswers = vocabulary
                    .filter(item => item.han !== correctAnswer)
                    .map(item => item.han);
            } else {
                // Lấy đáp án sai tiếng Việt
                wrongAnswers = vocabulary
                    .filter(item => item.vi !== correctAnswer)
                    .map(item => item.vi);
            }
            
            return shuffleArray(wrongAnswers).slice(0, count);
        }

        // Phát âm từ tiếng Hàn bằng file MP3
        function playKoreanWord(callback) {
            if (!currentQuestion) {
                console.log('Không có câu hỏi hiện tại');
                if (callback) callback();
                return;
            }
            
            const audioPlayer = document.getElementById('audioPlayer');
            const koreanWord = currentQuestion.han; // Luôn phát âm từ tiếng Hàn
            const audioFileName = `${koreanWord}.mp3`;
            const audioUrl = `${currentAudioPath}/${audioFileName}`;
            
            console.log('Đang phát file âm thanh:', audioUrl);
            
            const soundBtn = document.querySelector('.sound-btn');
            if (soundBtn) {
                soundBtn.classList.add('playing');
            }
            
            // Cấu hình audio player
            audioPlayer.src = audioUrl;
            audioPlayer.currentTime = 0;
            
            // Event listeners cho audio
            audioPlayer.onloadstart = function() {
                console.log('Bắt đầu tải file âm thanh');
            };
            
            audioPlayer.oncanplay = function() {
                console.log('File âm thanh sẵn sàng phát');
            };
            
            audioPlayer.onplay = function() {
                console.log('Bắt đầu phát âm:', koreanWord);
            };
            
            audioPlayer.onended = function() {
                console.log('Kết thúc phát âm');
                if (soundBtn) {
                    soundBtn.classList.remove('playing');
                }
                if (callback) callback();
            };
            
            audioPlayer.onerror = function(event) {
                console.error('Lỗi phát âm:', event);
                console.error('Không thể tải file:', audioUrl);
                if (soundBtn) {
                    soundBtn.classList.remove('playing');
                }
                
                // Fallback to text-to-speech nếu file không tồn tại
                console.log('Sử dụng text-to-speech làm phương án dự phòng');
                fallbackToTTS(koreanWord, callback);
            };
            
            // Phát âm thanh
            audioPlayer.play().catch(error => {
                console.error('Không thể phát âm thanh:', error);
                if (soundBtn) {
                    soundBtn.classList.remove('playing');
                }
                
                // Fallback to text-to-speech
                fallbackToTTS(koreanWord, callback);
            });
        }

        // Phương án dự phòng: sử dụng text-to-speech
        function fallbackToTTS(koreanWord, callback) {
            if (!('speechSynthesis' in window)) {
                console.log('Trình duyệt không hỗ trợ phát âm');
                if (callback) callback();
                return;
            }
            
            speechSynthesis.cancel();
            
            const utterance = new SpeechSynthesisUtterance(koreanWord);
            utterance.lang = 'ko-KR';
            utterance.rate = 0.8;
            utterance.pitch = 1.0;
            utterance.volume = 1.0;
            
            utterance.onend = function() {
                console.log('Kết thúc phát âm TTS');
                if (callback) callback();
            };
            
            utterance.onerror = function(event) {
                console.error('Lỗi phát âm TTS:', event.error);
            };
            
            speechSynthesis.speak(utterance);
        }

        // Cập nhật số đếm câu hỏi
        function updateQuestionCounter() {
            document.getElementById('questionCounter').textContent = 
                `Câu ${currentQuestionIndex + 1} / ${totalQuestions}`;
        }

        // Hiển thị thông báo hoàn thành
        function showCompletionMessage() {
            // Hide current quiz container
            const container = document.querySelector('.container');
            container.style.display = 'none';

            // Calculate score percentage
            const total = totalQuestions;
            const correct = correctAnswerCount;
            const scorePercentage = Math.round((correct / total) * 100);
            const isPerfectScore = correct === total;
            
            // Choose content based on score
            let resultIcon, resultTitle, resultMessage, resultColor;
            
            if (isPerfectScore) {
                // Perfect score - congratulations screen
                resultIcon = '🎉';
                resultTitle = 'Xuất sắc!';
                resultMessage = 'Bạn đã trả lời đúng tất cả các câu hỏi!';
                resultColor = '#28a745';
            } else if (scorePercentage >= 80) {
                // Good score
                resultIcon = '👏';
                resultTitle = 'Rất tốt!';
                resultMessage = 'Bạn đã làm rất tốt! Hãy tiếp tục cố gắng!';
                resultColor = '#17a2b8';
            } else if (scorePercentage >= 60) {
                // Average score
                resultIcon = '📚';
                resultTitle = 'Cần cố gắng thêm!';
                resultMessage = 'Bạn đã hoàn thành bài học. Hãy ôn tập và thử lại!';
                resultColor = '#ffc107';
            } else {
                // Low score
                resultIcon = '💪';
                resultTitle = 'Đừng nản chí!';
                resultMessage = 'Học tiếng Hàn cần thời gian. Hãy ôn tập và thử lại!';
                resultColor = '#dc3545';
            }

            // Create results container
            const resultsContainer = document.createElement('div');
            resultsContainer.className = 'container';
            resultsContainer.style.animation = 'fadeIn 0.5s ease-in';
            resultsContainer.innerHTML = `
                <div style="text-align: center; padding: 40px 20px;">
                    <div style="font-size: 4rem; margin-bottom: 20px; animation: bounce 1s ease-in-out;">${resultIcon}</div>
                    <h2 style="color: ${resultColor}; font-size: 2rem; font-weight: 700; margin-bottom: 16px;">${resultTitle}</h2>
                    <div style="color: #6c757d; font-size: 1.1rem; margin-bottom: 8px;">Bạn đã hoàn thành bài học</div>
                    <div style="font-size: 1.3rem; color: #007bff; font-weight: 600; margin-bottom: 24px;">${getLessonName(params.get("vocab"))}</div>
                    <div style="background: linear-gradient(135deg, ${resultColor}20, ${resultColor}10); border: 2px solid ${resultColor}; border-radius: 16px; padding: 30px; margin: 24px 0;">
                        <div style="font-size: 3rem; font-weight: bold; color: ${resultColor}; margin-bottom: 10px;">
                            ${correct}/${total}
                        </div>
                        <div style="font-size: 1.5rem; color: ${resultColor}; font-weight: 600; margin-bottom: 10px;">
                            ${scorePercentage}% chính xác
                        </div>
                        <div style="font-size: 1rem; color: #6c757d;">
                            Bạn đã trả lời đúng ${correct} trên ${total} câu hỏi
                        </div>
                    </div>
                    <p style="font-size: 1.1rem; color: #6c757d; margin-bottom: 32px; line-height: 1.5;">${resultMessage}</p>
                    <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                        <button onclick="restartLesson()" style="background: #28a745; color: white; border: none; border-radius: 8px; padding: 14px 24px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 2px 8px rgba(40, 167, 69, 0.3);">
                            Làm lại bài
                        </button>
                        <button onclick="goToIndex()" style="background: #007bff; color: white; border: none; border-radius: 8px; padding: 14px 24px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 2px 8px rgba(0, 123, 255, 0.3);">
                            Quay lại trang chủ
                        </button>
                    </div>
                </div>
            `;

            // Add CSS animations if not already present
            if (!document.querySelector('#result-animations')) {
                const style = document.createElement('style');
                style.id = 'result-animations';
                style.textContent = `
                    @keyframes fadeIn {
                        from { opacity: 0; transform: translateY(20px); }
                        to { opacity: 1; transform: translateY(0); }
                    }
                    @keyframes bounce {
                        0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
                        40% { transform: translateY(-20px); }
                        60% { transform: translateY(-10px); }
                    }
                    button:hover {
                        transform: translateY(-2px) !important;
                        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2) !important;
                    }
                `;
                document.head.appendChild(style);
            }

            // Insert results container after header
            document.body.appendChild(resultsContainer);
        }

        // Restart lesson function
        function restartLesson() {
            // Reset all counters and state
            currentQuestionIndex = 0;
            correctAnswerCount = 0;
            wrongAnswerCount = 0;
            hasAnswered = false;
            
            // Remove results container
            const resultContainers = document.querySelectorAll('.container');
            resultContainers.forEach((container, index) => {
                if (index > 0) { // Keep the first container (original quiz container)
                    container.remove();
                }
            });
            
            // Show original container
            const originalContainer = document.querySelector('.container');
            originalContainer.style.display = 'block';
            
            // Restart the quiz
            setupQuestionQueue();
            loadNewQuestion();
        }

        // Trộn mảng
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        // Xử lý khi chọn đáp án
        function selectAnswer(optionIndex, selectedAnswer) {
            if (hasAnswered) return;
            
            hasAnswered = true;
            const isCorrect = selectedAnswer === correctAnswer;
            
            // Hiển thị kết quả cho từng option
            for (let i = 0; i < 4; i++) {
                const option = document.getElementById('option' + i);
                option.classList.add('disabled');
                
                if (currentAnswers[i] === correctAnswer) {
                    option.classList.add('correct');
                    const checkMark = document.createElement('span');
                    checkMark.className = 'check-mark';
                    checkMark.textContent = '✓';
                    option.appendChild(checkMark);
                } else if (i === optionIndex && !isCorrect) {
                    option.classList.add('incorrect');
                    const xMark = document.createElement('span');
                    xMark.className = 'x-mark';
                    xMark.textContent = '✗';
                    option.appendChild(xMark);
                }
            }
            
            // Hiển thị feedback
            const feedback = document.getElementById('feedback');
            if (isCorrect) {
                feedback.textContent = 'Chính xác! 🎉';
                feedback.className = 'feedback success';
                correctAnswerCount++;
                
                // Animation cho đáp án đúng
                document.getElementById('option' + optionIndex).classList.add('correct-animation');
            } else {
                feedback.textContent = 'Sai rồi! Đáp án đúng được tô màu xanh.';
                feedback.className = 'feedback error';
                wrongAnswerCount++;
            }
            
            // Enable next button
            document.getElementById('nextBtn').disabled = false;
        }

        // Khởi chạy ứng dụng khi tải xong
        if (vocabFile && vocabularyData[vocabFile]) {
            vocabulary = vocabularyData[vocabFile];
            init();
        } else {
            alert("Không tìm thấy bộ từ vựng hoặc thiếu tham số từ vựng");
        }
    </script>
</body>
</html>